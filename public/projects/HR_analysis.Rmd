---
categories:
- ""
- ""
date: "2020-10-10"
description: HR analysis
draft: false
image: pic07.jpg
keywords: ""
slug: HR
title: HR analysis
---

>
IBM data scientists created this fictitional data set to document many job-related characteristics such as employees' ages, job satisfaction and outcomes like job salaries and attrition. Are there potential relationships between these variables?<br/>
Let's explore.
>

```{r, setup, echo=FALSE}
knitr::opts_chunk$set(
  message = FALSE, 
  warning = FALSE, 
  tidy=FALSE,     # display code as typed
  size="small")   # slightly smaller font for code
options(digits = 3)

# default figure size
knitr::opts_chunk$set(
  fig.width=6.75, 
  fig.height=6.75,
  fig.align = "center"
)
```


```{r load-libraries, warning=FALSE, message=FALSE, echo=FALSE}
library(tidyverse)  # Load ggplot2, dplyr, and all the other tidyverse packages
library(mosaic)
library(ggthemes)
library(lubridate)
library(fivethirtyeight)
library(here)
library(skimr)
library(janitor)
library(vroom)
library(tidyquant)
library(rvest)    # scrape websites
library(purrr)  
library(lubridate) #to handle dates
```

```{r}

hr_dataset <- read.csv("datasets_1067_1925_WA_Fn-UseC_-HR-Employee-Attrition.csv")
glimpse(hr_dataset)

```
```{r}

hr_cleaned <- hr_dataset %>% 
  clean_names() %>% 
  mutate(
    education = case_when(
      education == 1 ~ "Below College",
      education == 2 ~ "College",
      education == 3 ~ "Bachelor",
      education == 4 ~ "Master",
      education == 5 ~ "Doctor"
    ),
    environment_satisfaction = case_when(
      environment_satisfaction == 1 ~ "Low",
      environment_satisfaction == 2 ~ "Medium",
      environment_satisfaction == 3 ~ "High",
      environment_satisfaction == 4 ~ "Very High"
    ),
    job_satisfaction = case_when(
      job_satisfaction == 1 ~ "Low",
      job_satisfaction == 2 ~ "Medium",
      job_satisfaction == 3 ~ "High",
      job_satisfaction == 4 ~ "Very High"
    ),
    performance_rating = case_when(
      performance_rating == 1 ~ "Low",
      performance_rating == 2 ~ "Good",
      performance_rating == 3 ~ "Excellent",
      performance_rating == 4 ~ "Outstanding"
    ),
    work_life_balance = case_when(
      work_life_balance == 1 ~ "Bad",
      work_life_balance == 2 ~ "Good",
      work_life_balance == 3 ~ "Better",
      work_life_balance == 4 ~ "Best"
    )
  ) %>% 
  select(age, attrition, daily_rate, department,
         distance_from_home, education,
         gender, job_role,environment_satisfaction,
         job_satisfaction, marital_status,
         monthly_income, num_companies_worked, percent_salary_hike,
         performance_rating, total_working_years,
         work_life_balance, years_at_company,
         years_since_last_promotion)

```

Produce a one-page summary describing this dataset. Here is a non-exhaustive list of questions:

1. How often do people leave the company (`attrition`)

```{r, attrition}
glimpse(hr_cleaned)

attrition_prop <- hr_cleaned %>% 
  group_by(attrition)%>%
  summarise(n=n())%>%
  mutate(attrition_proportion=n/sum(n))
```
1. How are `age`, `years_at_company`, `monthly_income` and `years_since_last_promotion` distributed? can you roughly guess which of these variables is closer to Normal just by looking at summary statistics? 

```{r,distribution}
skim(hr_cleaned)

ggplot(hr_cleaned,aes(x=age))+
  geom_histogram()+
  labs(title = "Distribution of Employee Ages", subtitle = "Most number of employees are between age 30 and 35", x = "Age", y = "Number of People")+
  theme_minimal()+
  theme(title = element_text(size =15,face = "bold"), axis.title.x = element_text(size = 10), axis.title.y = element_text(size = 10, angle = 90))

ggplot(hr_cleaned,aes(x=years_at_company))+
  geom_histogram()+
  labs(title = "Distribution of Years Worked at Company", subtitle = "A right-skewed distribution shows most employees have worked for very few years", x = "Years at Company", y="Number of People")+
  theme_minimal()+
  theme(title = element_text(size =15,face = "bold"), axis.title.x = element_text(size = 10), axis.title.y = element_text(size = 10, angle = 90))

ggplot(hr_cleaned,aes(x=monthly_income))+
  geom_histogram()+
  labs(title="Distribution of Monthly Income", subtitle = "Right-skewed distribution : most people are paid less",  x="Monthly Income", y="Number of People")+
  theme_minimal()+
  theme(title = element_text(size =15,face = "bold"), axis.title.x = element_text(size = 10), axis.title.y = element_text(size = 10, angle = 90))

ggplot(hr_cleaned,aes(x=years_since_last_promotion))+
  geom_histogram()+
  labs(title="Distribution of Years since Last Promotion", subtitle = "Most number of people have not yet been promoted", x="Years since Last Promotion", y="Number of People")+
  theme_minimal()+
  theme(title = element_text(size =15,face = "bold"), axis.title.x = element_text(size = 10), axis.title.y = element_text(size = 10, angle = 90))
```

1. How are `job_satisfaction` and `work_life_balance` distributed? Don't just report counts, but express categories as % of total

```{r,distribution2}
p1<- hr_cleaned %>%
  group_by(job_satisfaction)%>%
  summarise(n=n())%>%
  mutate(prop=n/sum(n))

p1

ggplot(p1, aes(x=reorder(job_satisfaction,-prop),y=prop))+
         geom_bar(stat="identity")+
  labs(title = "Proportions of Job Satisfaction", x = "Job Satisfaction", y = "Proportion")
       

```

1. Is there any relationship between monthly income and education? Monthly income and gender?

```{r, income_education_gender} 

ggplot(hr_cleaned, aes(x=monthly_income, color=education))+
  geom_histogram(position = "dodge")+
  labs(title = "Distribution of Income and Education", x="Monthly Income", y = "Number of People")

ggplot(hr_cleaned, aes(x=monthly_income, color=gender))+
  geom_histogram(position = "dodge")+
  labs(title = "Distribution of Income and Gender", x="Monthly Income", y = "Number of People")


```
1. Plot a boxplot of income vs job role. Make sure the highest-paid job roles appear first
```{r, boxplot}
ggplot(hr_cleaned, aes(x=reorder(job_role,-monthly_income),y=monthly_income))+
  geom_boxplot()+
  labs(title = "Boxplot of Monthly Income for Each Job Role", x = "Job Roles", y="Monthly Income")
  

```

1. Calculate and plot a bar chart of the mean (or median?) income by education level.

```{r, education_level}
p3 <- hr_cleaned%>%
  group_by(education)%>%
  summarise(mean_income = mean(monthly_income))

ggplot(p3, aes(x=reorder(education,-mean_income),y=mean_income))+
  geom_bar(stat = "identity")+
  labs(title = "Mean Income of Different Education Levels", x="Education Level", y = "Mean Income")

```
1. Plot the distribution of income by education level. Use a facet_wrap and a theme from `ggthemes`

```{r, income_educationlevel}
ggplot(hr_cleaned, aes(x=monthly_income))+
  geom_histogram()+
  facet_wrap(~education)+
  theme_light()+
  labs(title = "Distribution of Income by Education Level", x= "Monthly Income", y = "Count")

```

1. Plot income vs age, faceted by `job_role`
```{r, income_age}
ggplot(hr_cleaned, aes(x=age, y=monthly_income))+
  geom_bar(stat = "identity")+
  facet_wrap(~job_role)+
  theme_light()+
  labs(title = "Distribution of Income by Age", x= "Age", y = "Income")

```
## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

